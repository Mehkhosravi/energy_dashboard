{% extends "base.html" %}

{% block title %}Energy Dashboard{% endblock %}

{% block content %}
<section class="pt-25 px-4">
  <div class="flex gap-4 items-start w-full">

    <!-- Filter + Download -->
    <div class="flex flex-col gap-4 w-[240px]">
      <!-- Filter Sidebar -->
      <div class="bg-gray-100 rounded-xl p-4 shadow-sm">
        <h2 class="text-md font-semibold mb-4">Filter Section:</h2>

        <div class="mb-3">
          <label for="levelSelect" class="block text-sm font-medium mb-1">Select Level:</label>
          <select id="levelSelect" class="w-full p-2 border rounded">
            <option value="">-- Choose Level --</option>
            <option value="region">Region</option>
            <option value="province">Province</option>
            <option value="comune">Municipality</option>
          </select>
        </div>

        <div class="mb-3">
          <label for="areaSelect" class="block text-sm font-medium mb-1">Select Area:</label>
          <select id="areaSelect" class="w-full p-2 border rounded">
            <option value="">-- Choose --</option>
          </select>
        </div>

        {% include "partials/chart_controls.html" %}
        
      </div>

      <!-- Download Panel -->
      <div class="bg-gray-100 rounded-xl p-4 shadow-sm">
        <h2 class="text-md font-semibold mb-3">Download File:</h2>
        <button id="downloadChart" class="bg-blue-500 text-white px-4 py-2 mb-2 w-full rounded hover:bg-blue-600">Download Chart</button>
        <button id="downloadMap" class="bg-green-500 text-white px-4 py-2 w-full rounded hover:bg-green-600">Download Map</button>
      </div>
    </div>

    <!-- Map + Charts Section -->
    <div class="flex-1 grid grid-cols-1 xl:grid-cols-2 gap-4">

      <!-- Map Section -->
      <div class="bg-white rounded-xl p-4 shadow-sm col-span-1 xl:col-span-1">
        <div id="map" class="w-full h-[480px] border rounded-xl"></div>
      </div>

      <!-- Charts -->
      <div class="grid grid-cols-2 gap-4 w-full">
        <div class="bg-white rounded-xl p-3 shadow">
          <h2 class="text-md font-semibold mb-2">Energy Production vs Consumption</h2>
          <canvas id="chartProductionConsumption"></canvas>
        </div>
        <div class="bg-white rounded-xl p-3 shadow">
          <h2 class="text-md font-semibold mb-2">Self-Sufficiency Over Time</h2>
          <canvas id="chartSelfSufficiency"></canvas>
        </div>
        <div class="bg-white rounded-xl p-3 shadow">
          <h2 class="text-md font-semibold mb-2">Future Energy Forecast</h2>
          <canvas id="chartFutureForecast"></canvas>
        </div>
        <div class="bg-white rounded-xl p-3 shadow">
          <h2 class="text-md font-semibold mb-2">Energy Type Distribution</h2>
          <canvas id="chartEnergyTypeDistribution"></canvas>
        </div>
      </div>

    </div>
  </div>
</section>


<!-- âœ… Then your app scripts -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='js/chart_controls.js') }}"></script>
<script src="{{ url_for('static', filename='js/dashboard_map.js') }}"></script>
{% endblock %}
