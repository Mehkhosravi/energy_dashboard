{% extends "base.html" %}

{% block title %}Energy Dashboard{% endblock %}

{% block content %}
<!-- LEVEL SELECTOR -->
<div class="mb-4 max-w-4xl mx-auto">
  <label for="levelSelect" class="block text-sm font-medium mb-1">Select Level:</label>
  <select id="levelSelect" class="w-full p-2 border rounded">
    <option value="">-- Choose Level --</option>
    <option value="region">Region</option>
    <option value="province">Province</option>
    <option value="comune">Municipality</option>
  </select>
</div>

<!-- DYNAMIC NAME SELECTOR -->
<div class="mb-6 max-w-4xl mx-auto">
  <label for="areaSelect" class="block text-sm font-medium mb-1">Select Area:</label>
  <select id="areaSelect" class="w-full p-2 border rounded" disabled>
    <option value="">-- Select a level first --</option>
  </select>
</div>


  <!-- Map Section -->
  <div id="map" class="w-full h-[500px] rounded-xl border my-6"></div>


  <!-- Charts Section -->
  <div class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-6xl mx-auto">
    <!-- Chart 1 -->
    <div class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-semibold mb-2">Energy Production vs Consumption</h2>
      <canvas id="chartProductionConsumption"></canvas>
    </div>

    <!-- Chart 2 -->
    <div class="bg-white rounded-xl shadow-md p-4">
      <h2 class="text-lg font-semibold mb-2">Self-Sufficiency Over Time</h2>
      <canvas id="chartSelfSufficiency"></canvas>
    </div>
  </div>
</section>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const ctx1 = document.getElementById('chartProductionConsumption');
  new Chart(ctx1, {
    type: 'bar',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr'],
      datasets: [
        { label: 'Production', data: [120, 150, 180, 200], backgroundColor: 'rgba(34, 197, 94, 0.6)' },
        { label: 'Consumption', data: [100, 130, 160, 190], backgroundColor: 'rgba(239, 68, 68, 0.6)' }
      ]
    }
  });

  const ctx2 = document.getElementById('chartSelfSufficiency');
  new Chart(ctx2, {
    type: 'line',
    data: {
      labels: ['Jan', 'Feb', 'Mar', 'Apr'],
      datasets: [
        { label: 'Self-Sufficiency %', data: [80, 85, 78, 90], borderColor: 'rgba(59, 130, 246, 1)', fill: false }
      ]
    }
  });
</script>
<script src="{{ url_for('static', filename='js/dashboard_map.js') }}"></script>
{% endblock %}

